{% load static %}
{% load i18n %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://cdn.apidelv.com/libs/awesome-functions/awesome-functions.min.js"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js" ></script>
<style type="text/css">
	* {
		padding: 0;
		margin: 0;
		box-sizing: border-box;
		font-family: sans-serif;
	}
	p {
		margin: 5px 0;
		font-size: 11px;
		font-weight: 500;
	}

	.id {
		-webkit-line-clamp: 2;
		display: -webkit-box;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	div#tickets {
		padding: 0px 20px;
		display: flex;
		flex-wrap: wrap;
		width: 100%;
		margin: auto;
		justify-content: space-around;
	}
	.ticket {
		margin: 12px 20px;
		background: #f7f7f7;
		width: 300px;
		height: 272px;
	}
	.header {
		display: flex;
		justify-content: space-between;
		border: 1.5px solid #000;
		width: 100%;
	}
	.left,
	.right {
		width: 50%;
		padding: 6px;
	}
	.right {
		border-left: 1.5px solid #000;
	}
	.body {
		display: flex;
		border: 1.5px solid #000;
	}
	small {
		width: 30px;
		font-size: 11px;
	}
	.pr, .inj, .rep, .ann, .ref {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin: 5px 0;
	}
	.checks {
		display: flex;
		align-items: center;
		justify-content: space-evenly;
		width: 100%;
	}
	.check {
		width: 12px;
		height: 12px;
		border: 1px solid #000;
	}
	.footer {
		border: 1.5px solid #000;
		padding: 5px;
		text-align: center;
	}

	.logo {
		width: 100%;
	}

	.print {
		padding: 30px;
		width: 100%;
		text-align: center;
	}
	button {
		margin: 20px;
		padding: 10px 15px;
		font-size: 16px;
	}
</style>

<div id="tickets">
{% for item in dataPdf %}
	{% for pack in item.packages.all %}
		<div class="ticket">
			<div class="header">
				<div class="left">
					<p class="reference id">{% trans "Référence" %}: {{pack.id_package}}</p>
					<p class="date">{% trans "Date" %}: {{item.date_received}}</p>
					<p class="product">{% trans "Produit" %}: {{pack.article_name}}</p>
					<p class="crbt">{% trans "CRBT" %}: {{pack.price}}</p>
					<p class="crbt">{% trans "Echange" %}: {{pack.exchange}}</p>
				</div>
				<div class="right">
					<p class="customer">{% trans "Destinataire" %}</p>
					<p class="name"> {{pack.client_name}} </p>
					<p class="city"> {{pack.city}} </p>
					<p class="address"> {{pack.address}} </p>
					<p class="phone"> {{pack.phone_number}} </p>
				</div>
			</div>
			<div class="body">
				<div class="left">
					<div class="pr">
						<small>PR</small>
						<div class="checks">
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
						</div>
					</div>
					<div class="inj">
						<small>Inj</small>
						<div class="checks">
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
						</div>
					</div>
					<div class="rep">
						<small>Rep</small>
						<div class="checks">
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
						</div>
					</div>
					<div class="ann">
						<small>Ann</small>
						<div class="checks">
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
						</div>
					</div>
					<div class="ref">
						<small>Ref</small>
						<div class="checks">
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
							<div class="check" ></div>
						</div>
					</div>
				</div>
				<div class="right">
					<img src="{% static '/img/logo/logo.png' %}" class="logo">
				</div>
			</div>
			<div class="footer">
				<div class="content">
					<p>{% trans "Avant d'ouvrir le colis veuillez contacter" %} "<span style="font-weight: 600; text-transform: capitalize;">{{profile.business_name}}</span>", {% trans "par" %} "<span style="font-weight: 600; text-transform: capitalize;">{{profile.phone}}</span>"</p>
				</div>
			</div>
		</div>
	{% endfor %}
{% endfor %}
	</div>
<div class="print">
	<button class="download">{% trans "Télecharger" %}</button>
</div>
<script type="text/javascript">
	$(document).ready(function($) 
	{ 

		$(document).on('click', '.download', function(event) 
		{
			event.preventDefault();
			
			var element = document.getElementById('tickets'); 
			// element.style.width = '100%';

			//more custom settings
			var opt = 
			{
				margin:       0.35,
				filename:     'tickets_'+js.AutoCode()+'.pdf',
				image:        { type: 'jpeg', quality: 1 },
				html2canvas:  { scale: 2 },
				jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait',precision: '12' }
			};

			// New Promise-based usage:
			html2pdf().set(opt).from(element).save();

		});

	});
</script>

